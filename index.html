<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Telegram Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .navbar {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid var(--tg-theme-hint-color, #ccc);
            position: fixed;
            bottom: 0;
            width: 100%;
            background: var(--tg-theme-bg-color, #fff);
            z-index: 100;
        }
        .nav-btn {
            background: none;
            border: none;
            color: var(--tg-theme-hint-color, #888);
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        .nav-btn.active {
            color: var(--tg-theme-button-color, #3390ec);
            font-weight: bold;
        }
        .nav-icon { font-size: 20px; margin-bottom: 2px; }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü */
        .page {            flex: 1;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 70px; /* –º–µ—Å—Ç–æ –ø–æ–¥ –º–µ–Ω—é */
            display: none;
        }
        .page.active { display: block; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ */
        .product-card {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—à–∫–∏ "–ö—É–ø–ª–µ–Ω–æ" */
            overflow: hidden;
        }
        .product-img {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        .rating { color: #ffc107; font-size: 14px; margin: 5px 0; }
        .daisies { color: #4caf50; font-size: 12px; }
        
        .btn-main {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
            cursor: pointer;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏) */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            justify-content: center;
            align-items: flex-end;
        }        .modal-content {
            background: var(--tg-theme-bg-color, #fff);
            width: 100%;
            border-radius: 20px 20px 0 0;
            padding: 25px;
            box-sizing: border-box;
            animation: slideUp 0.3s ease-out;
            max-height: 80vh;
            overflow-y: auto;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        /* –≠–∫—Ä–∞–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —É—Å–ø–µ—Ö–∞ */
        .loader-screen, .success-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            position: fixed;
            top: 0; left: 0; width: 100%;
            background: var(--tg-theme-bg-color, #fff);
            z-index: 300;
            text-align: center;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--tg-theme-button-color, #3390ec);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        .dots-spinner { font-size: 30px; letter-spacing: 5px; animation: blink 1.5s infinite; display: none; }
        .checkmark {
            width: 60px; height: 60px;
            border-radius: 50%;
            background: #4caf50;
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 30px;
            margin-bottom: 20px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes blink { 0%, 100% { opacity: 0.2; } 50% { opacity: 1; } }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }

        .status-text { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
        .sub-text { color: var(--tg-theme-hint-color, #888); font-size: 14px; }
        /* –°—Ç–∞—Ç—É—Å –∫—É–ø–ª–µ–Ω–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */
        .bought-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.85);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            font-weight: bold;
            color: #4caf50;
            font-size: 20px;
            text-transform: uppercase;
            z-index: 10;
        }
        .bought-overlay span { font-size: 40px; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>

    <!-- –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê -->
    <div id="home-page" class="page active">
        <h2 style="text-align:center;">–ú–∞–≥–∞–∑–∏–Ω –†–æ–º–∞—à–µ–∫ üåº</h2>
        
        <div class="product-card" onclick="openProductDetails()">
            <div class="bought-overlay" id="bought-status">
                <span>‚úÖ</span>–ö–£–ü–õ–ï–ù–û!
            </div>
            
            <!-- –¢–í–û–Ø –°–°–´–õ–ö–ê –ù–ê –†–û–ú–ê–®–ö–£ -->
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7kQOJWw3QYInj6qZ1w7tmfUOZkGKo7JIa5n99tz6uTw&s=10" alt="–†–æ–º–∞—à–∫–∞" class="product-img">
            
            <h3>–°—É–ø–µ—Ä –†–æ–º–∞—à–∫–∞</h3>
            <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4,7</div>
            <div class="daisies">üåºüåºüåºüåºüåº</div>
            <p style="font-size: 13px; color: #666;">–ù–∞–∂–º–∏ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π</p>
        </div>
    </div>

    <!-- –°–¢–†–ê–ù–ò–¶–ê –ü–†–û–§–ò–õ–¨ -->
    <div id="profile-page" class="page">
        <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
        <p>–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ... üîú</p>
        <div style="text-align:center; font-size: 50px; margin-top: 50px;">üë§</div>
    </div>

    <!-- –°–¢–†–ê–ù–ò–¶–ê –ë–ê–ù–ö -->
    <div id="bank-page" class="page">        <h2>–ë–∞–Ω–∫</h2>
        <p>–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ... üîú</p>
        <div style="text-align:center; font-size: 50px; margin-top: 50px;">üè¶</div>
    </div>

    <!-- –ù–ò–ñ–ù–ï–ï –ú–ï–ù–Æ -->
    <div class="navbar">
        <button class="nav-btn active" onclick="switchTab('home')">
            <span class="nav-icon">üè†</span> –ì–ª–∞–≤–Ω–∞—è
        </button>
        <button class="nav-btn" onclick="switchTab('profile')">
            <span class="nav-icon">üë§</span> –ü—Ä–æ—Ñ–∏–ª—å
        </button>
        <button class="nav-btn" onclick="switchTab('bank')">
            <span class="nav-icon">üè¶</span> –ë–∞–Ω–∫
        </button>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –¢–û–í–ê–†–ê -->
    <div id="product-modal" class="modal" onclick="if(event.target === this) closeProductDetails()">
        <div class="modal-content">
            <!-- –¢–í–û–Ø –°–°–´–õ–ö–ê –ù–ê –†–û–ú–ê–®–ö–£ -->
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7kQOJWw3QYInj6qZ1w7tmfUOZkGKo7JIa5n99tz6uTw&s=10" alt="–†–æ–º–∞—à–∫–∞" style="width: 100px; display:block; margin: 0 auto 15px; border-radius: 10px;">
            
            <h3 style="text-align:center;">–°—É–ø–µ—Ä –†–æ–º–∞—à–∫–∞</h3>
            <div class="rating" style="text-align:center;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4,7</div>
            <p style="line-height: 1.5; color: #555; margin-top: 15px;">
                –≠—Ç–æ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è —Ä–æ–º–∞—à–∫–∞. –û–Ω–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç —É–¥–∞—á—É, —Ä–∞–¥—É–µ—Ç –≥–ª–∞–∑ –∏ –æ—Ç–ª–∏—á–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç—Å—è –≤ –≤–∞—à–µ–º —Ü–∏—Ñ—Ä–æ–≤–æ–º —Å–∞–¥—É. 
                –†–µ–π—Ç–∏–Ω–≥ 4.7 –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –æ—Ç–∑—ã–≤–∞—Ö —Ç—ã—Å—è—á —Å—á–∞—Å—Ç–ª–∏–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!
            </p>
            <div style="font-size: 20px; font-weight: bold; margin: 15px 0; text-align: center;">–¶–µ–Ω–∞: 50 üíé</div>
            
            <button class="btn-main" onclick="startPaymentProcess()">üí≥ –ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å</button>
            <button class="btn-main" style="background-color: var(--tg-theme-secondary-bg-color, #eee); color: #333; margin-top: 10px;" onclick="closeProductDetails()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò –û–ü–õ–ê–¢–´ -->
    <div id="loading-screen" class="loader-screen">
        <div class="spinner" id="circle-loader"></div>
        <div class="dots-spinner" id="dots-loader">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div class="status-text" id="load-status">–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞...</div>
        <div class="sub-text">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</div>
    </div>

    <!-- –≠–ö–†–ê–ù –£–°–ü–ï–•–ê -->
    <div id="success-screen" class="success-screen">
        <div class="checkmark">‚úì</div>
        <div class="status-text">–û–ø–ª–∞—á–µ–Ω–æ!</div>
        <div class="sub-text">–í–∞—à —Ç–æ–≤–∞—Ä —É–∂–µ –≤ –ø—É—Ç–∏</div>        <button class="btn-main" style="width: auto; margin-top: 30px;" onclick="finishSuccess()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabName + '-page').classList.add('active');
            const btns = document.querySelectorAll('.nav-btn');
            if(tabName === 'home') btns[0].classList.add('active');
            if(tabName === 'profile') btns[1].classList.add('active');
            if(tabName === 'bank') btns[2].classList.add('active');
        }

        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function openProductDetails() {
            document.getElementById('product-modal').style.display = 'flex';
        }
        function closeProductDetails() {
            document.getElementById('product-modal').style.display = 'none';
        }

        // –õ–æ–≥–∏–∫–∞ –ø–æ–∫—É–ø–∫–∏
        function startPaymentProcess() {
            closeProductDetails();
            
            const data = {
                action: "buy_request",
                item_id: "daisy_001",
                item_name: "–°—É–ø–µ—Ä –†–æ–º–∞—à–∫–∞",
                price: 50,
                // –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É –¥–ª—è –±–æ—Ç–∞
                image_url: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7kQOJWw3QYInj6qZ1w7tmfUOZkGKo7JIa5n99tz6uTw&s=10"
            };
            tg.sendData(JSON.stringify(data));
            tg.close();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (–¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É—Å–ø–µ—Ö–∞)
        if (window.location.hash === "#success") {
            runSuccessAnimation();
        }

        function runSuccessAnimation() {
            document.getElementById('loading-screen').style.display = 'flex';            
            // –≠—Ç–∞–ø 1: –ö—Ä—É–≥–ª–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (2 —Å–µ–∫)
            setTimeout(() => {
                document.getElementById('circle-loader').style.display = 'none';
                document.getElementById('dots-loader').style.display = 'block';
                document.getElementById('load-status').innerText = "–°–≤—è–∑—å —Å –±–∞–Ω–∫–æ–º...";
                
                // –≠—Ç–∞–ø 2: –¢–æ—á–∫–∏ (3 —Å–µ–∫)
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                    document.getElementById('success-screen').style.display = 'flex';
                    
                    localStorage.setItem('daisy_bought', 'true');
                }, 3000);
            }, 2000);
        }

        function finishSuccess() {
            window.location.hash = "";
            document.getElementById('success-screen').style.display = 'none';
            switchTab('home');
            
            if(localStorage.getItem('daisy_bought') === 'true') {
                document.getElementById('bought-status').style.display = 'flex';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º —Å—Ç–∞—Ä—Ç–µ
        if(localStorage.getItem('daisy_bought') === 'true') {
            document.getElementById('bought-status').style.display = 'flex';
        }
    </script>
</body>
    </html>
